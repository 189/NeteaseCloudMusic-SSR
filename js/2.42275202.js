webpackJsonp([2],{712:function(e,t,a){"use strict";function l(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(23),i=l(n),s=a(5),r=l(s),c=a(27),u=l(c),o=a(1),m=l(o),d=a(2),f=l(d),p=a(3),y=l(p),g=a(4),v=l(g),h=a(0),E=l(h),_=a(77),N=a(144),A=a(6),k=l(A),S=(a(33),a(54)),I=a(55),P=a(715),b=a(738),x=l(b),C=a(97),L=(l(C),a(273)),w=l(L);a(740);var T=function(e){function t(){var e,a,l,n;(0,m.default)(this,t);for(var i=arguments.length,s=Array(i),r=0;r<i;r++)s[r]=arguments[r];return a=l=(0,y.default)(this,(e=t.__proto__||(0,u.default)(t)).call.apply(e,[this].concat(s))),l.state={isPlay:!0,currentIndex:0,playlists:[],similar_Already:!1,simiSongLists:[],simiSong_Already:!1},l.Audio=null,l.simiPlaylist=function(e){(0,S.fetchJson)({type:"post",url:"/musicApi/neteaseMusic/weapi/discovery/simiPlaylist",data:{limit:6,offset:10,total:!1,n:6,songid:e,csrf_token:""}}).then(function(e){if(200==e.code){var t=e.playlists;l.setState({playlists:t,similar_Already:!0})}else I.StaticToast.error(e.msg)})},l.simiSong=function(e){(0,S.fetchJson)({type:"post",url:"/musicApi/neteaseMusic/weapi/discovery/simiSong",data:{songid:e,csrf_token:""}}).then(function(e){if(200==e.code){var t=e.songs;l.setState({simiSongLists:t,simiSong_Already:!0})}else I.StaticToast.error(e.msg)})},l.initAudio=function(e){l.Audio=new Audio(e),l.Audio.autoplay=!0,l.Audio.addEventListener("timeupdate",function(){return l.timeupdate()}),l.Audio.addEventListener("ended",function(){l.isPlayHandler(),l.Audio.currentTime=0,l.setState({currentIndex:0})})},l.timeupdate=function(){if(l.Audio){var e=l.Audio.currentTime,t=void 0===e?0:e,a=l.findLyricByTime(l.state.currentIndex);t>=a&&"number"==typeof a&&l.setState({currentIndex:++l.state.currentIndex})}},l.findLyricByTime=function(e){var t=l.props._lyricInfo.list;return t.length?e>=t.length-1?t[t.length-1].time:t[e+1].time:null},l.isPlayHandler=function(){l.setState({isPlay:!l.state.isPlay},function(){l.state.isPlay?l.Audio.play():l.Audio.pause()})},n=a,(0,y.default)(l,n)}return(0,v.default)(t,e),(0,f.default)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,a=t.ACTIONS,l=t.location.query,n={id:l.id};a.player_fetch(n).then(function(t){e.initAudio(t.data[0].url),e.simiPlaylist(n.id),e.simiSong(n.id)}),a.getLyric(n),a.song_detail(n)}},{key:"componentWillUnmount",value:function(){var e=this;this.Audio.pause(),this.Audio.removeEventListener("timeupdate",function(){return e.timeupdate()}),this.Audio=null}},{key:"render",value:function(){var e=this.state,t=e.isPlay,l=e.currentIndex,n=e.playlists,i=e.similar_Already,s=e.simiSongLists,c=e.simiSong_Already,u=this.props,o=u._playerInfo.nemwxs,m=u._lyricInfo,d=m.list,f=m.lyric_Already;return E.default.createElement("div",{className:"songs-page"},E.default.createElement("section",{className:"song-play"},E.default.createElement("div",{className:"s-play-chunk",onClick:this.isPlayHandler},E.default.createElement("p",{className:"l-t-logo"},E.default.createElement(I.Svg,{href:a(741)+"#svg-lt-logo"})),E.default.createElement("div",{className:(0,k.default)("s-p-box a-circling",{"z-pause":!t})},E.default.createElement("div",{className:"s-p-inner"},E.default.createElement("img",{className:"singer-img",src:o.picUrl+"?imageView&thumbnail=400x0&quality=75&tostatic=0",alt:""})),E.default.createElement("p",{className:"s-play-btn"},E.default.createElement(I.Svg,{hash:"svg-play-song"}))),E.default.createElement("i",{className:"needle"})),E.default.createElement("div",{className:"s-play-info"},!!f&&E.default.createElement("h3",null,o.title+" - ",E.default.createElement("span",{className:"song-autr"},o.content)),E.default.createElement("div",{className:"s-play-lyrics"},E.default.createElement("ul",{className:"lyrics-transform",style:this.state.currentIndex>1?{transform:"translateY(-"+30*(l-1)+"px)"}:{}},f?d.length<=0?E.default.createElement("li",{className:"lyrics-row"},"暂无歌词..."):d.map(function(e,t){return E.default.createElement("li",{className:(0,k.default)("lyrics-row",{active:l==t}),key:"lyrics"+t},e.content)}):E.default.createElement("li",{className:"lyrics-row"},"歌词获取中...")))),E.default.createElement("i",{className:"song-bg",style:o.picId_str?{backgroundImage:"url(//music.163.com/api/img/blur/"+o.picId_str+")"}:{}})),!!n.length&&E.default.createElement(M,(0,r.default)({playlists:n,similar_Already:i},this.props)),!!s.length&&E.default.createElement(U,(0,r.default)({simiSongLists:s,simiSong_Already:c},this.props)),E.default.createElement(x.default,this.props))}}],[{key:"loadData",value:function(e){if(e&&e.store){var t=e.props.location.query;return e.store.dispatch(w.default.player_fetch({id:t.id}))}this.props.ACTIONS.player_fetch()}}]),t}(h.Component),M=function(e){var t=e.similar_Already,a=e.playlists,l=(0,i.default)(e,["similar_Already","playlists"]);return E.default.createElement("section",{className:"m-moreLists"},E.default.createElement(I.PanelNav,{className:"fff",title:"包含这首歌的歌单"}),E.default.createElement("div",{className:"recommend"},t?a.map(function(e,t){return E.default.createElement(I.RecommendChunk,(0,r.default)({className:"fff",key:e.id,item:(0,r.default)({},e,{picUrl:e.coverImgUrl})},l))}):E.default.createElement(P.Homeremd,{len:3})))},U=function(e){var t=e.simiSong_Already,a=e.simiSongLists;(0,i.default)(e,["simiSong_Already","simiSongLists"]);return E.default.createElement("section",{className:"m-moreLists m-moreSongs"},E.default.createElement(I.PanelNav,{className:"fff",title:"喜欢这首歌的人也听"}),E.default.createElement("div",{className:"simisong-list"},t?a.map(function(e,t){var a=e.name,l=e.album,n=e.artists,s=e.alias,c=(0,i.default)(e,["name","album","artists","alias"]);return E.default.createElement(I.Piece,{item:(0,r.default)({},c,{name:a,picUrl:l.blurPicUrl,custom_alia:s,custom_ar:n,index:t},e),isSerial:2,key:t})}):E.default.createElement(P.Homeremd,{len:3})))},H=function(e){var t=e.songIndex;return{_playerInfo:t.server_player_info,_lyricInfo:t.lyric_info}},O=function(e){return{ACTIONS:(0,_.bindActionCreators)(w.default,e)}};t.default=(0,N.connect)(H,O)(T),e.exports=t.default},738:function(e,t,a){"use strict";function l(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(27),i=l(n),s=a(1),r=l(s),c=a(2),u=l(c),o=a(3),m=l(o),d=a(4),f=l(d),p=a(0),y=l(p),g=a(6),v=(l(g),a(33)),h=a(54),E=a(55),_=a(97),N=l(_);a(739);var A=function(e){function t(){var e,a,l,n;(0,r.default)(this,t);for(var s=arguments.length,c=Array(s),u=0;u<s;u++)c[u]=arguments[u];return a=l=(0,m.default)(this,(e=t.__proto__||(0,i.default)(t)).call.apply(e,[this].concat(c))),l.state={hotComments:[],comments:[],total:0},l.Audio=null,l.initData=function(){(0,h.fetchJson)({type:"POST",url:"/musicApi/neteaseMusic/weapi/v1/resource/comments/get",data:{resourceId:l.props.location.query.id,limit:15,resourceType:4,csrf_token:""}}).then(function(e){if(200==e.code){var t=e.hotComments,a=e.comments,n=e.total,i=t.length>=10?[]:a.slice(0,5);l.setState({hotComments:t.slice(0,10),comments:i,total:n})}else E.StaticToast.error(e.msg)})},l.applink=function(){v.browserHistory.push({pathname:"/author/works"})},n=a,(0,m.default)(l,n)}return(0,f.default)(t,e),(0,u.default)(t,[{key:"componentDidMount",value:function(){this.initData()}},{key:"render",value:function(){var e=this.state,t=e.hotComments,a=e.comments,l=e.total;return y.default.createElement("section",{className:"m-comments"},t.length>0?y.default.createElement(k,{data:t,applink:this.applink,title:"精彩评论"}):null,a.length>0&&t.length<15?y.default.createElement(k,{data:a,title:"最新评论("+l+")",applink:this.applink}):null,!!l>0&&y.default.createElement("p",{className:"cmt-more"},y.default.createElement("span",{onClick:this.applink},"查看全部"+l+"条评论")))}}]),t}(p.Component),k=function(e){var t=e.data,a=e.title,l=e.applink;return y.default.createElement("div",null,y.default.createElement(E.PanelNav,{title:a}),y.default.createElement("ul",{className:"comm-list"},t.map(function(e,t){return y.default.createElement("li",{className:"comm-li",key:e.commentId},y.default.createElement("p",{className:"comm-user"},y.default.createElement(v.Link,null,y.default.createElement("img",{src:e.user.avatarUrl.replace(/jpg|png|jpeg/i,"")+"webp?imageView&thumbnail=60x0&quality=75&tostatic=0&type=webp",alt:""}))),y.default.createElement("div",{className:"comm-info"},y.default.createElement("div",{className:"cmt-header"},y.default.createElement("div",{className:"cmt-meta"},y.default.createElement("p",null,y.default.createElement(v.Link,{className:"nickname"},e.user.nickname)),y.default.createElement("p",{className:"time"},N.default.formatMsgTime(e.time))),y.default.createElement("div",{className:"cmt-like",onClick:function(){return l()}},!!e.likedCount>0&&e.likedCount," ",y.default.createElement(E.Svg,{hash:"svg-praise"}))),y.default.createElement("div",{className:"cmt-content"},e.content)))})))};t.default=A,e.exports=t.default},739:function(e,t){},740:function(e,t){},741:function(e,t,a){e.exports=a.p+"fonts/icon.ec2d6afa.svg"}});